// ==================
// TEAM MENU
// ==================

/**
 * @todo rename the menu according to the file
 */
window team extends iaircraft
{
	// ==================
	// background
	// ==================

	panel actors_background {
		pos		"18 443"
		size	"329 321"
		image	"ui/panel_grey_green_large"
	}

	panel actormodel_background {
		pos		"358 443"
		size	"205 321"
		image	"ui/panel_grey_green_large"
	}

	panel actorstats_background {
		pos		"564 443"
		size	"458 321"
		image	"ui/panel_grey_green_large"
	}

	// ==================
	// aircraft
	// ==================

	model aircraft
	{
		model		*cvar:mn_aircraft_model
		pos			"478 107"
		size		"529 260"
		origin		"-45 25 0"
		angles		"160 20 -120"
		view		aircraft
	}

	string team_members
	{
		string	"_Team Members:"
		pos		"480 107"
		size	"200 20"
	}

	string team_hired
	{
		string		*cvar:mn_hired
		pos			"619 107"
		size		"62 20"
		textalign	ur
	}

	func listen_close_equipment
	{
		cmd "team_select <cvar:cl_selected2>"
		cmd "del cl_selected2"
		cmd "mn_removelistener equipment@onClose <path:this>"
	}

	button bt_equipsoldiers
	{
		string "_Equip soldiers"
		pos		"483 129"
		size	"198 43"
		image	ui/button_blue
		onClick	{
			*cvar:cl_selected2 <cvar:cl_selected>
			cmd "mn_addlistener equipment@onClose <path:root>.listen_close_equipment"
			cmd "mn_push equipment"
		}
		color	"1 1 1 0.8"
		selectcolor "1 1 1 1"
	}
	todo equip_soldiers_subtab {
		pos "463 135"
		string "It would be nice to create a mockup and prototype to equip soldiers with another aircraft tab - should be a very nice short cut"
	}

	// ==================
	// names list
	// ==================

	/**
	 * @param[in] <1> id of employee in the list
	 */
	confunc aircraft_soldier_usedelsewhere
	{
		*txt_actor<1>@color ".50 .50 .50 1"
		*(checkbox)check_actor<1>@current 0
		*(checkbox)check_actor<1>@tooltip "_Soldier is assigned to another craft"
		*check_actor<1>@disabled true
		*check_actor<1>@invis false
		*txt_actor<1>@invis false
		*(pic)bt_equip<1>@invis false
	}

	/**
	 * @param[in] <1> id of employee in the list
	 */
	confunc aircraft_soldier_unassigned {
		*txt_actor<1>@color "0 .78 0 1"
		*check_actor<1>@disabled false
		*(checkbox)check_actor<1>@current 0
		*check_actor<1>@invis false
		*txt_actor<1>@invis false
		*(pic)bt_equip<1>@invis false
		if ( *cvar:mn_hirable_count == 0 ) {
			*(checkbox)check_actor<1>@disabled true
			*(checkbox)check_actor<1>@tooltip "_No more soldiers can be assigned to this craft"
		} else {
			*(checkbox)check_actor<1>@tooltip "_Assign soldier to this craft"
		}
	}

	/**
	 * @param[in] <1> id of employee in the list
	 */
	confunc aircraft_soldier_assigned {
		*txt_actor<1>@color "0 .78 0 1"
		*check_actor<1>@disabled false
		*(checkbox)check_actor<1>@current 1
		*(checkbox)check_actor<1>@tooltip "_Remove soldier from this craft"
		*check_actor<1>@invis false
		*txt_actor<1>@invis false
		*(pic)bt_equip<1>@invis false
	}

	/**
	 * @param[in] <1> id of employee in the list
	 */
	confunc aircraft_soldier_holdsequip {
		*(pic)bt_equip<1>@tooltip "_Soldier carries equipment"
		*(pic)bt_equip<1>@texl "16 0"
		*(pic)bt_equip<1>@texh "32 16"
	}

	/**
	 * @param[in] <1> id of employee in the list
	 */
	confunc aircraft_soldier_holdsnoequip {
		*(pic)bt_equip<1>@tooltip "_Soldier carries no equipment"
		*(pic)bt_equip<1>@texl "0 0"
		*(pic)bt_equip<1>@texh "16 16"
	}

	/**
	 * @param[in] <1> id of employee in the list
	 */
	confunc aircraft_soldier_unusedslot {
		*(pic)bt_equip<1>@invis true
		*check_actor<1>@invis true
		*txt_actor<1>@invis true
	}

	/**
	 * @param[in] <1> number of employee in the list
	 */
	confunc aircraft_soldier_list_size {
		*(abstractscrollbar)scroll_employees@fullsize <1>
	}

	/**
	 * @param[in] <1> number of employee in the list
	 */
	confunc aircraft_soldier_selected {
		*txt_actor<1>@color "1 1 1 1"
	}

	pic bt_equip0
	{
		pos			"38 470"
		image		ui/button_equip
		mousefx		false
		texl		"0 0"
		texh		"16 16"
		invis		true
	}

	pic bt_equip1
	{
		pos			"38 505"
		image		ui/button_equip
		mousefx		false
		texl		"0 0"
		texh		"16 16"
		invis		true
	}

	pic bt_equip2
	{
		pos			"38 540"
		image		ui/button_equip
		mousefx		false
		texl		"0 0"
		texh		"16 16"
		invis		true
	}

	pic bt_equip3
	{
		pos			"38 575"
		image		ui/button_equip
		mousefx		false
		texl		"0 0"
		texh		"16 16"
		invis		true
	}

	pic bt_equip4
	{
		pos			"38 610"
		image		ui/button_equip
		mousefx		false
		texl		"0 0"
		texh		"16 16"
		invis		true
	}

	pic bt_equip5
	{
		pos			"38 645"
		image		ui/button_equip
		mousefx		false
		texl		"0 0"
		texh		"16 16"
		invis		true
	}

	pic bt_equip6
	{
		pos			"38 680"
		image		ui/button_equip
		mousefx		false
		texl		"0 0"
		texh		"16 16"
		invis		true
	}

	pic bt_equip7
	{
		pos			"38 715"
		image		ui/button_equip
		mousefx		false
		texl		"0 0"
		texh		"16 16"
		invis		true
	}

	// checkbox

	checkbox check_actor0
	{
		pos	"280 470"
		onChange { cmd "team_hire 0 <cvar:mn_relative_id>;" }
		current 0
		image ui/checkbox_green
		size "20 20"
		invis	true
	}
	checkbox check_actor1
	{
		pos	"280 505"
		onChange { cmd "team_hire 1 <cvar:mn_relative_id>;" }
		current 0
		image ui/checkbox_green
		size "20 20"
		invis	true
	}
	checkbox check_actor2
	{
		pos	"280 540"
		onChange { cmd "team_hire 2 <cvar:mn_relative_id>;" }
		current 0
		image ui/checkbox_green
		size "20 20"
		invis	true
	}
	checkbox check_actor3
	{
		pos	"280 575"
		onChange { cmd "team_hire 3 <cvar:mn_relative_id>;" }
		current 0
		image ui/checkbox_green
		size "20 20"
		invis	true
	}
	checkbox check_actor4
	{
		pos	"280 610"
		onChange { cmd "team_hire 4 <cvar:mn_relative_id>;" }
		current 0
		image ui/checkbox_green
		size "20 20"
		invis	true
	}
	checkbox check_actor5
	{
		pos	"280 645"
		onChange { cmd "team_hire 5 <cvar:mn_relative_id>;" }
		current 0
		image ui/checkbox_green
		size "20 20"
		invis	true
	}
	checkbox check_actor6
	{
		pos	"280 680"
		onChange { cmd "team_hire 6 <cvar:mn_relative_id>;" }
		current 0
		image ui/checkbox_green
		size "20 20"
		invis	true
	}
	checkbox check_actor7
	{
		pos	"280 715"
		onChange { cmd "team_hire 7 <cvar:mn_relative_id>;" }
		current 0
		image ui/checkbox_green
		size "20 20"
		invis	true
	}

	string txt_actor0
	{
		string	*cvar:mn_ename0
		pos		"60 460"
		size	"190 35"
		textalign cl
		onClick { cmd "team_select 0 <cvar:mn_relative_id>;" }
		invis	true
		onWheelUp 	{ cmd "mn_active_vscrollbar <path:root>.scroll_employees 0" } // 0: click on top
		onWheelDown { cmd "mn_active_vscrollbar <path:root>.scroll_employees 4" } // 4: click on bottom
	}
	string txt_actor1
	{
		string	*cvar:mn_ename1
		pos		"60 495"
		size	"190 35"
		textalign cl
		onClick { cmd "team_select 1 <cvar:mn_relative_id>;" }
		invis	true
		onWheelUp 	{ cmd "mn_active_vscrollbar <path:root>.scroll_employees 0" } // 0: click on top
		onWheelDown { cmd "mn_active_vscrollbar <path:root>.scroll_employees 4" } // 4: click on bottom
	}
	string txt_actor2
	{
		string	*cvar:mn_ename2
		pos		"60 530"
		size	"190 35"
		textalign cl
		onClick { cmd "team_select 2 <cvar:mn_relative_id>;" }
		invis	true
		onWheelUp 	{ cmd "mn_active_vscrollbar <path:root>.scroll_employees 0" } // 0: click on top
		onWheelDown { cmd "mn_active_vscrollbar <path:root>.scroll_employees 4" } // 4: click on bottom
	}
	string txt_actor3
	{
		string	*cvar:mn_ename3
		pos		"60 565"
		size	"190 35"
		textalign cl
		onClick { cmd "team_select 3 <cvar:mn_relative_id>;" }
		invis	true
		onWheelUp 	{ cmd "mn_active_vscrollbar <path:root>.scroll_employees 0" } // 0: click on top
		onWheelDown { cmd "mn_active_vscrollbar <path:root>.scroll_employees 4" } // 4: click on bottom
	}
	string txt_actor4
	{
		string	*cvar:mn_ename4
		pos		"60 600"
		size	"190 35"
		textalign cl
		onClick { cmd "team_select 4 <cvar:mn_relative_id>;" }
		invis	true
		onWheelUp 	{ cmd "mn_active_vscrollbar <path:root>.scroll_employees 0" } // 0: click on top
		onWheelDown { cmd "mn_active_vscrollbar <path:root>.scroll_employees 4" } // 4: click on bottom
	}
	string txt_actor5
	{
		string	*cvar:mn_ename5
		pos		"60 635"
		size	"190 35"
		textalign cl
		onClick { cmd "team_select 5 <cvar:mn_relative_id>;" }
		invis	true
		onWheelUp 	{ cmd "mn_active_vscrollbar <path:root>.scroll_employees 0" } // 0: click on top
		onWheelDown { cmd "mn_active_vscrollbar <path:root>.scroll_employees 4" } // 4: click on bottom
	}
	string txt_actor6
	{
		string	*cvar:mn_ename6
		pos		"60 670"
		size	"190 35"
		textalign cl
		onClick { cmd "team_select 6 <cvar:mn_relative_id>;" }
		invis	true
		onWheelUp 	{ cmd "mn_active_vscrollbar <path:root>.scroll_employees 0" } // 0: click on top
		onWheelDown { cmd "mn_active_vscrollbar <path:root>.scroll_employees 4" } // 4: click on bottom
	}
	string txt_actor7
	{
		string	*cvar:mn_ename7
		pos		"60 705"
		size	"190 35"
		textalign cl
		onClick { cmd "team_select 7 <cvar:mn_relative_id>;" }
		invis	true
		onWheelUp 	{ cmd "mn_active_vscrollbar <path:root>.scroll_employees 0" } // 0: click on top
		onWheelDown { cmd "mn_active_vscrollbar <path:root>.scroll_employees 4" } // 4: click on bottom
	}

	vscrollbar scroll_employees
	{
		image	ui/scrollbar_v_green
		pos "310 463"	height	"282"
		current 0
		viewsize 8
		fullsize 50
		onChange {
			cmd "update_soldier_list 8 <current>"
			*cvar:mn_relative_id <current>
		}
	}

	// ==================
	// actor info
	// ==================

	pic	rank_img {
		pos "378 465"
		size "50 50"
		image *cvar:mn_chrrank_img
	}

	model body
	{
		{
			model	*cvar:mn_body
			skin	*cvar:mn_skin
			anim	"stand2"
			angles	"0 70 90"
			scale	"5.5 5.5 5.5"
			pos		"378 465"
			size	"167 278"
			origin	"0 -35 0"
		}

		model head
		{
			model	*cvar:mn_head
			skin	*cvar:mn_skin
			tag		"tag_head"
			scale	"1.0 1.0 1.0"
		}
	
		model right_rweapon
		{
			model	*cvar:mn_rweapon
			tag		"tag_rweapon"
		}
	
		model right_lweapon
		{
			model	*cvar:mn_lweapon
			tag		"tag_lweapon"
		}
	}

	string	name { pos "380 700" size "165 20" string *cvar:mn_name }
	string	rank_lbl { pos "380 720" size "165 20" string *cvar:mn_chrrank }

	pic pwr_bdr    { pos "750 472"  image ui/bar_border }
	tbar pwr_bar   { pos "752 472"  current *cvar:mn_vpwr texl "3 0" image ui/bar_attribute size "250 16"	max 100 }
	string pwr_lbl { pos "585 470" size "200 20" string "_Strength:" }
	string pwr_val { pos "850 470" size "150 20" string *cvar:mn_tpwr textalign ur }

	pic spd_bdr    { pos "750 495" image ui/bar_border }
	tbar spd_bar   { pos "752 495" current *cvar:mn_vspd texl "3 0" image ui/bar_attribute size "250 16"	max 100 }
	string spd_lbl { pos "585 493" size "200 20" string "_Speed:" }
	string spd_val { pos "850 493" size "150 20" string *cvar:mn_tspd textalign ur }

	pic acc_bdr    { pos "750 518" image ui/bar_border }
	tbar acc_bar   { pos "752 518" current *cvar:mn_vacc texl "3 0" image ui/bar_attribute size "250 16"	max 100 }
	string acc_lbl { pos "585 516" size "200 20" string "_Accuracy:" }
	string acc_val { pos "850 516" size "150 20" string *cvar:mn_tacc textalign ur }

	pic mnd_bdr    { pos "750 541" image ui/bar_border }
	tbar mnd_bar   { pos "752 541" current *cvar:mn_vmnd texl "3 0" image ui/bar_attribute size "250 16"	max 100 }
	string mnd_lbl { pos "585 539" size "200 20" string "_Mind:" }
	string mnd_val { pos "850 539" size "150 20" string *cvar:mn_tmnd textalign ur }

	pic cls_bdr    { pos "750 564" image ui/bar_border }
	tbar cls_bar   { pos "752 564" current *cvar:mn_vcls texl "3 0" image ui/bar_skill size "250 16"	max 100 }
	string cls_lbl { pos "585 562" size "200 20" string "_Close Combat:" }
	string cls_val { pos "850 562" size "150 20" string *cvar:mn_tcls textalign ur }

	pic hvy_bdr    { pos "750 587" image ui/bar_border }
	tbar hvy_bar   { pos "752 587" current *cvar:mn_vhvy texl "3 0" image ui/bar_skill size "250 16"	max 100 }
	string hvy_lbl { pos "585 585" size "200 20" string "_Heavy Weapons:" }
	string hvy_val { pos "850 585" size "150 20" string *cvar:mn_thvy textalign ur }

	pic ass_bdr    { pos "750 610" image ui/bar_border }
	tbar ass_bar   { pos "752 610" current *cvar:mn_vass texl "3 0" image ui/bar_skill size "250 16"	max 100 }
	string ass_lbl { pos "585 608" size "200 20" string "_Assault Weapons:" }
	string ass_val { pos "850 608" size "150 20" string *cvar:mn_tass textalign ur }

	pic snp_bdr    { pos "750 633" image ui/bar_border }
	tbar snp_bar   { pos "752 633" current *cvar:mn_vsnp texl "3 0" image ui/bar_skill size "250 16"	max 100 }
	string snp_lbl { pos "585 631" size "200 20" string "_Sniper Rifles:" }
	string snp_val { pos "850 631" size "150 20" string *cvar:mn_tsnp textalign ur }

	pic exp_bdr    { pos "750 656" image ui/bar_border }
	tbar exp_bar   { pos "752 656" current *cvar:mn_vexp texl "3 0" image ui/bar_skill size "250 16"	max 100 }
	string exp_lbl { pos "585 654" size "200 20" string "_High-Explosives:" }
	string exp_val { pos "850 654" size "150 20" string *cvar:mn_texp textalign ur }

	pic hp_bdr { pos "750 679" image ui/bar_border }
	tbar hp_bar {
		current	*cvar:mn_vhp
		max	*cvar:mn_vhpmax
		pos "752 679"
		texl "3 0"
		image ui/bar_health
		size "250 16"
	}
	string hp_lbl { pos "585 677" size "200 20" string "_Health:" }
	string hp_val { pos "850 677" size "150 20" string *cvar:mn_thp textalign ur }

	string	missions_lbl { pos "585 700" size "200 20" string "_Missions Performed:" }
	string	missions_val { pos "850 700" size "150 20" string *cvar:mn_chrmis textalign ur }

	string	kills_lbl { pos "585 723" size "200 20" string "_Enemies Killed:" }
	string	kills_val { pos "850 723" size "150 20" string *cvar:mn_chrkillalien textalign ur }

	//mn_chrkillcivilian
	//mn_chrkillteam

	/** @todo Activate this again - used for UGVs */
	// ==================
	// additional stuff
	// ==================
	confunc toggle_show_heavybutton {
		*bt_switch_list@tooltip	"_Assign tanks"
		*bt_switch_list@icon	uvc
	}
	confunc toggle_show_soldiersbutton {
		*bt_switch_list@tooltip	"_Assign soldiers"
		*bt_switch_list@icon	soldier
	}

	/**
	 * @note call when the aircraft status change
	 */
	confunc aircraft_status_change
	{
		if ( *cvar:mn_hired_count > 0 ) {
			*bt_equipsoldiers@disabled = false
			*bt_equipsoldiers@tooltip = "_Equip soldiers"
		} else {
			*bt_equipsoldiers@disabled true
			*bt_equipsoldiers@tooltip = "_No soldiers assigned"
		}
	}

	/**
	 * @note iaircraft interface
	 */
	confunc aircraft_change
	{
		cmd "update_soldier_list 8 0;team_select 0;set mn_show_employee 1;"
		*scroll_employees@current 0
		*aircraft_list@lineselected <1>
		// absent from base, go back to the main GUI
		if ( *cvar:mn_equipsoldierstate == 1 ) {
			cmd "mn_pop;mn_push aircraft;"
		}
		cmd "aircraft_status_change"
	}

	func onInit
	{
		cmd "mn_select_aircraft <cvar:mn_aircraft_id>"
		*scroll_employees@current 0
		*cvar:mn_relative_id = 0
		cmd "update_soldier_list 8 0;team_select 0;set mn_show_employee 1;"
		cmd "aircraft_status_change"
	}
}
